import BaseHTTPServer, SimpleHTTPServer
import ssl, sys, os

# This is necessary to use a hardware wallet with Urbit Wallet
# this script needs a self-signed certificate, which can be generated by running
# openssl req -new -x509 -keyout localhost.pem -out localhost.pem -days 3650 -nodes

os.chdir('../')

def main(): 
    httpd = BaseHTTPServer.HTTPServer(('0.0.0.0', 4443), 
      SimpleHTTPServer.SimpleHTTPRequestHandler)
    if len(sys.argv) < 2:
      print """
        script takes one arg: <path-to-certfile>
        run
        
        openssl req -new -x509 -keyout localhost.pem -out localhost.pem -days 3650 -nodes
        
        to generate a new certfile at ./localhost.pem"""
    else:
      httpd.socket = ssl.wrap_socket (httpd.socket, certfile=sys.argv[1], server_side=True)
      httpd.serve_forever()

if __name__ == "__main__":
  main()

